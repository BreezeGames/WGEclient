"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function Render(a,b,c){if(!a)throw new Error("[Render constructor]: wrong _canvas element");this._canvas=a,debug("[Render constructor]: initializing webGL context"),this._ctx=null;try{this._ctx=this._canvas.getContext("webgl")||this._canvas.getContext("experemental-webgl")}catch(a){}if(!this._ctx)throw new Error("[Render constructor]: webgl not supported!");b&&(this._canvas.width=b),c&&(this._canvas.height=c),this._renderScene=null,this._isFullScreen=!1}function parseShader(a,b){var c=null;switch(b){case VERTEX_SHADER:c="vertex";break;case FRAGMENT_SHADER:c="fragment";break;default:throw new Error("Appropriate shader type")}var d=a.querySelector('shader[type="'+c+'"]');if(console.info(d),!d)throw new Error("Can't find shader resource of type "+c);return d.textContent}function Shader(a,b,c){if(debug("[Shader constructor]: creating shader"),this._shaderText=null,this._shader=null,this._type=c,this._shaderText=parseShader(b),this._shader=a.createShader(this._type),a.shaderSource(this._shader,this._shaderText),a.compileShader(this._shader),!a.getShaderParameter(this._shader,a.COMPILE_STATUS)){var d=a.getShaderInfoLog(this._shader);throw new Error("shader compile error \n "+d)}}function debug(a){IS_DEBUG&&console.log(a)}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Buffer=function(){function a(b,c,d){var e=arguments.length<=3||void 0===arguments[3]?STATIC_DRAW:arguments[3];_classCallCheck(this,a),debug("[Buffer constructor]: Constructing buffer");try{this._data=c,this._type=d,this._drawType=e,this.gl=b,this._buffer=b.createBuffer(),this.gl.bindBuffer(this._type,this._buffer),this.gl.bufferData(this._type,new Float32Array(this._data),this._drawType)}catch(a){throw new Error("[Buffer constructor] error: "+a)}}return _createClass(a,[{key:"bind",value:function(){this.gl.bindBuffer(this._type,this._buffer)}},{key:"data",get:function(){return this._data}}]),a}(),IS_DEBUG=!0,VERTEX_SHADER=35633,FRAGMENT_SHADER=35632,ARRAY_BUFFER=34962,ELEMENT_ARRAY_BUFFER=34963,STREAM_DRAW=35040,STATIC_DRAW=35044,DYNAMIC_DRAW=35048,LINK_STATUS=35714,FLOAT=5126,TRIANGLE_STRIP=5;Render.prototype.setRenderScene=function(a){a&&(this._renderScene=a)},Render.prototype.width=function(a){return a?(this._canvas.width=a,void this.viewport(0,0,this.width(),this.height())):this._canvas.width},Render.prototype.height=function(a){return a?(this._canvas.height=a,void this.viewport(0,0,this.width(),this.height())):this._canvas.height},Render.prototype.getCanvas=function(){return this._canvas},Render.prototype.getContext=function(){return this._ctx},Render.prototype.clearColor=function(a,b,c,d){return a?void this._ctx.clearColor(a,b,c,d):this._ctx.getParameter(this._ctx.COLOR_CLEAR_VALUE)},Render.prototype.clearScreen=function(a){var b=this._ctx.COLOR_BUFFER_BIT;b|=a?this._ctx.DEPTH_BUFFER_BIT:0,this._ctx.clear(b)},Render.prototype.draw=function(){this._renderScene&&(this._renderScene.update(),this._renderScene.draw())},Render.prototype.viewport=function(a,b,c,d){this._ctx.viewport(a,b,c,d)},Render.prototype.setFullScreen=function(a){this._isFullScreen!=a&&(a?(this.canvasW=this.width(),this.canvasH=this.height(),this._isFullScreen=!0,this.viewport(0,0,window.innerWidth,window.innerHeight),this.width(window.innerWidth),this.height(window.innerHeight)):(this._isFullScreen=!1,this.width(this.canvasW),this.height(this.canvasH),this.viewport(0,0,this.width(),this.height())))};var Scene=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"init",value:function(){throw new Error("Init method not implemented")}},{key:"draw",value:function(){throw new Error("Draw method not implemented")}},{key:"update",value:function(){throw new Error("Update method not implemented")}}]),a}();Shader.prototype.shader=function(){return(void 0)._shader},Shader.prototype.type=function(){return(void 0)._type};var Program=function(){function a(b,c,d){if(_classCallCheck(this,a),this._gl=b,this._program=b.createProgram(),c&&b.attachShader(this._program,c.shader()),d&&b.attachShader(this._program,d.shader()),b.linkProgram(this._program),!b.getProgramParameter(this._program,LINK_STATUS))throw new Error("[Program constructor] linking error")}return _createClass(a,[{key:"getAttribute",value:function(a){return this._gl.getAttribLocation(this._program,a)}},{key:"use",value:function(){this._gl.useProgram(this._program)}},{key:"program",get:function(){return this._program}}]),a}();